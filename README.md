🃏 Ξερή – Web API Card Game
Μάθημα: Ανάπτυξη Διαδικτυακών Συστημάτων και Εφαρμογών
📌 Περιγραφή Project

Η παρούσα εργασία αφορά την υλοποίηση ενός Web API για το παιχνίδι χαρτιών «Ξερή», το οποίο αποτελεί παραλλαγή της Κολτσίνας.
Η εφαρμογή υλοποιήθηκε στο πλαίσιο του μαθήματος Ανάπτυξη Διαδικτυακών Συστημάτων και Εφαρμογών και έχει ως στόχο την κατανόηση και εφαρμογή βασικών εννοιών ανάπτυξης διαδικτυακών συστημάτων, όπως:

RESTful API σχεδίαση

Διαχείριση κατάστασης παιχνιδιού (game state)

Stateless HTTP requests με χρήση sessions / cookies

Επικοινωνία client–server μέσω JSON

Διασύνδεση με βάση δεδομένων

Modular αρχιτεκτονική backend

Το παιχνίδι υλοποιείται χωρίς γραφικό περιβάλλον, και η αλληλεπίδραση γίνεται αποκλειστικά μέσω HTTP requests (curl).
Η κατάσταση του παιχνιδιού αποθηκεύεται σε MySQL βάση δεδομένων, ενώ κάθε ενέργεια επιστρέφει JSON απάντηση.

🎮 Κανόνες Παιχνιδιού (Σύνοψη)

Το παιχνίδι παίζεται με 2 παίκτες

Κάθε γύρο μοιράζονται 6 χαρτιά σε κάθε παίκτη

Στην αρχή τοποθετούνται 4 χαρτιά στο τραπέζι

Οι παίκτες παίζουν εναλλάξ

Μάζεμα γίνεται όταν:

Παίζεται ίδιος αριθμός με το πάνω χαρτί

Παίζεται Βαλέ (J) → μαζεύει όλα τα χαρτιά

Ξερή: όταν υπάρχει ένα μόνο χαρτί στο τραπέζι και μαζευτεί

Ξερή με Βαλέ δίνει περισσότερους πόντους

Το παιχνίδι τελειώνει όταν τελειώσει η τράπουλα και παιχτούν όλα τα χαρτιά

🌐 Περιγραφή Web API

Η εφαρμογή εκθέτει ένα σύνολο από HTTP endpoints, τα οποία χρησιμοποιούνται για τη ροή του παιχνιδιού.

▶️ POST /api/start.php

Δημιουργεί νέο παιχνίδι.

Παράμετροι

player1, player2


Λειτουργία

Δημιουργεί νέο game στη βάση

Παράγει tokens παικτών

Ο παίκτης 1 θεωρείται αρχικά συνδεδεμένος

▶️ POST /api/join.php

Σύνδεση παίκτη σε υπάρχον παιχνίδι.

Παράμετροι

game_id, token


Λειτουργία

Επικυρώνει το token

Καταχωρεί τον παίκτη στο session

Το παιχνίδι ξεκινά μόνο όταν συνδεθούν και οι δύο παίκτες

▶️ POST /api/roll.php

Μοίρασμα χαρτιών – αρχή γύρου.

Παράμετροι

game_id


Λειτουργία

Μοιράζει 6 χαρτιά σε κάθε παίκτη

Στον πρώτο γύρο:

Δημιουργείται και ανακατεύεται η τράπουλα

Τοποθετούνται 4 χαρτιά στο τραπέζι

Ο παίκτης που έκανε το τελευταίο μάζεμα ξεκινά τον γύρο

▶️ POST /api/move.php

Κίνηση παίκτη.

Παράμετροι

game_id, card


Λειτουργία

Ελέγχει σειρά παίκτη

Ελέγχει αν το χαρτί υπάρχει στο χέρι

Υλοποιεί:

Ρίξιμο χαρτιού

Μάζεμα

Ξερή

Ξερή με Βαλέ

Ενημερώνει πόντους, piles, σειρά

▶️ GET /api/state.php

Επιστροφή κατάστασης παιχνιδιού.

Παράμετροι

game_id


Λειτουργία

Επιστρέφει JSON με:

Τραπέζι

Γύρο

Σειρά

Πόντους

Κάρτες παίκτη (μόνο του καλούντος)

Flags ενεργειών (can_move, can_roll κ.λπ.)

▶️ POST /api/end_game.php

Τερματισμός παιχνιδιού & τελική βαθμολογία.

Παράμετροι

game_id


Λειτουργία

Υπολογίζει τελικό σκορ βάσει κανόνων:

Περισσότερα χαρτιά → +3

2♠ → +1

10♦ → +1

Ρήγας / Ντάμα / Βαλέ / 10 → +1

Ξερή → +10

Ξερή με Βαλέ → +20

Ορίζει νικητή

Κλειδώνει το παιχνίδι

🧱 Περιγραφή Βασικών PHP Αρχείων
ΑΝΑΛΥΤΙΚΗ ΠΕΡΙΓΡΑΦΗ API

📄start.php
Χρησιμοποιείται για τη δημιουργία νέου παιχνιδιού.
Α χικοποιεί την κατάσταση και ορίζει τον πρώτο παίκτη.

📄 join.php
Επιτρέπει τη συμμετοχή δεύτερου παίκτη σε υπάρχον παιχνίδι μέσω game_id.

📄 roll.php
Πραγματοποιεί το μοίρασμα των φύλλων σε νέο γύρο.
Ελέγχει ότι:

Και οι δύο παίκτες έχουν συνδεθεί

Τα χέρια είναι άδεια

Είναι η σειρά του σωστού παίκτη

📄move.php
Υλοποιεί την κίνηση παίκτη.
Ελέγχει:

Αν είναι η σειρά του παίκτη

Αν το φύλλο υπάρχει στο χέρι του

Αν προκύπτει σύλληψη, Ξερή ή Ξερή με Βαλέ
Ενημερώνει το σκορ και τη σειρά.

📄 state.php
Επιστρέφει την τρέχουσα κατάσταση του παιχνιδιού.
Περιλαμβάνει:

Γύρο

Σειρά παίκτη

Φύλλα στο τραπέζι

Σκορ

Επιτρεπτές ενέργειες (flags)

📄 end_game.php
Ολοκληρώνει το παιχνίδι όταν δεν υπάρχουν άλλα φύλλα.
Υπολογίζει:

Τελικό σκορ

Αναλυτικό breakdown βαθμολογίας

Νικητή

Παρότι τα παρακάτω αρχεία δεν καλούνται απευθείας μέσω curl, αποτελούν τον πυρήνα της εφαρμογής και πρέπει να περιλαμβάνονται στην παράδοση.

📄 Game.php

Κλάση μοντέλου του παιχνιδιού

Διαχειρίζεται:

Φόρτωση παιχνιδιού από τη βάση

Αποθήκευση κατάστασης (state_json)

Αποτελεί το βασικό abstraction layer μεταξύ API και βάσης δεδομένων

📄 bootstrap.php

Κοινό αρχείο αρχικοποίησης

Περιλαμβάνει:

Helpers (json_out, require_post, session helpers)

Λογική flags (can_move, can_roll κ.λπ.)

Functions για έλεγχο κατάστασης παιχνιδιού

Φορτώνεται από όλα τα API endpoints

📄 score.php

Περιλαμβάνει όλη τη λογική υπολογισμού βαθμολογίας

Υλοποιεί:

Live score

Τελικό score

Ανάλυση πόντων (breakdown)

Διαχωρίζει τη λογική scoring από το gameplay

📄 db.php

Υλοποιεί τη σύνδεση με τη βάση δεδομένων (MySQL)

Παρέχει PDO connection

Χρησιμοποιείται από όλα τα endpoints

📄 config.php

Περιέχει ρυθμίσεις εφαρμογής

Credentials βάσης δεδομένων

Global constants

📦 Παράδοση

Η παράδοση περιλαμβάνει:

Όλα τα PHP αρχεία του API

Τα core αρχεία (Game.php, bootstrap.php, db.php, config.php, score.php)

README.md (το παρόν αρχείο)

Το project εκτελείται τοπικά μέσω XAMPP και δοκιμάζεται με χρήση curl από command line.
